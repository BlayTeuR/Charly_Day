<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commande - Réstore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden-checkbox {
            display: none;
        }
        #announcementToggle:checked + #announcement {
            display: none;
        }
        .dropdown:hover .dropdown-menu {
            display: block;
        }
        .dropdown-menu {
            display: none;
        }
        @keyframes blink-white {
            0% { filter: brightness(1); }
            50% { filter: brightness(2); }
            100% { filter: brightness(1); }
        }

        .blink-white {
            animation: blink-white 1s ease-in-out;
        }
    </style>
</head>
<body class="bg-white text-[#095434] min-h-screen flex flex-col">

<input type="checkbox" id="announcementToggle" class="hidden-checkbox">

<div id="announcement" class="bg-gray-200 text-[#095434] text-center text-sm py-2 relative">
    Livraison en 5 à 10 jours ouvrés | Retrait gratuit en magasin
    <label for="announcementToggle" class="absolute top-0 right-0 mt-1 mr-2 text-gray-600 hover:text-gray-800 cursor-pointer">
        &times;
    </label>
</div>

<header class="bg-[#81A969] text-white shadow-lg">
    <div class="container mx-auto flex items-center justify-between pt-2 px-6">
        <div class="flex items-center">
            <img src="../img/logo_1_vert_foncé.png" alt="Réstore Logo" class="h-20 pl-10">
        </div>
        <nav class="flex space-x-8">
            <div class="dropdown relative">
                <button class="px-4 py-2 font-semibold  hover:text-[#095434] transition duration-200" id="dashboard_button">Dashboard</button>
            </div>
            <div class="dropdown relative">
                <button class="px-4 py-2 font-semibold hover:text-[#095434] transition duration-200" id="users_button">Users</button>
            </div>
            <div class="dropdown relative">
                <button class="px-4 py-2 font-semibold underline hover:text-[#095434] transition duration-200">Commandes</button>
            </div>
        </nav>
        <div class="flex items-center space-x-4">
            <div class="relative">
                <p class="px-4 py-2 rounded-full text-black focus:outline-none focus:ring-2 focus:ring-[#095434]">Interface ADMIN</p>
            </div>
            <div class="relative">
                <!-- Icône profil -->
                <a href="#" id="profileIcon" class="inline-block">
                    <img src="../img/baseProfil.png" alt="Profil" class="h-8">
                </a>
            </div>
        </div>
    </div>
</header>

<main class="flex-grow bg-gray-50">
    <div class="container mx-auto py-10 px-6">

    </div>
</main>

<footer class="bg-[#81A969] text-white text-center py-4">
    <p>&copy; 2025 Réstore - Tous droits réservés - <a href="mailto:contact@fly.fr" class="underline">Contactez-nous</a></p>
</footer>

</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("dashboard_button").addEventListener("click", function () {
            window.location.href = "/dashboard";  // Redirige vers la page à propos
        });

        document.getElementById("users_button").addEventListener("click", function () {
            window.location.href = "/users_admin";  // Redirige vers la page à propos
        });

        const profileIcon = document.getElementById("profileIcon");
        const profileMenu = document.getElementById("profileMenu");
        const loginOrLogoutLink = document.getElementById("loginOrLogoutLink");

        // Vérifier si l'utilisateur est connecté
        fetch("/api/is-logged-in", { credentials: "include" })
            .then(res => res.json())
            .then(data => {
                if (data.loggedIn) {
                    // Connecté => “Se déconnecter”
                    loginOrLogoutLink.textContent = "Se déconnecter";
                    // On veut, au clic, appeler /api/auth/logout puis recharger la page
                    loginOrLogoutLink.addEventListener("click", (e) => {
                        e.preventDefault();
                        fetch("/api/auth/logout")
                            .then(() => {
                                // On recharge la page, ou on redirige vers '/'
                                window.location.reload();
                            })
                            .catch(err => console.error("Erreur logout:", err));
                    });
                } else {
                    // Non connecté => “Se connecter”
                    loginOrLogoutLink.textContent = "Se connecter";
                    // On met un href = "/login"
                    loginOrLogoutLink.setAttribute("href", "/login");
                }
            })
            .catch(err => {
                console.error("Erreur is-logged-in:", err);
                // Par défaut, on propose “Se connecter”
                loginOrLogoutLink.textContent = "Se connecter";
                loginOrLogoutLink.href = "/login";
            });

        // Clic sur l’icône => toggle du menu
        profileIcon.addEventListener("click", (e) => {
            e.preventDefault();
            profileMenu.classList.toggle("hidden");
        });

        // Fermer le menu si clic en dehors
        document.addEventListener("click", (event) => {
            if (!profileMenu.contains(event.target) && !profileIcon.contains(event.target)) {
                profileMenu.classList.add("hidden");
            }
        });
    });
</script>
</html>
